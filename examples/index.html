<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello World | Native.js</title>
</head>
<body>
    <main id="app"></main>

    <template id="tpl-home">
        <h1 id="main-h1">Main Page</h1>
        <a n-href="/hello-world">Go to Hello World</a>
        <!-- Nested component example -->
        <n-footer></n-footer>
    </template>

    <template id="tpl-hello-world">
        <h2>Hello World Page</h2>
        <a n-href="/">Back to Home</a>
        <a n-href="/other-page">Go to Other Page</a>
        <n-footer></n-footer>
    </template>

    <template id="tpl-other-page">
        <h2>Other Page</h2>
        <a n-href="/">Back to Home</a>
        <n-footer></n-footer>
    </template>

    <template id="tpl-footer">
        <footer style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ccc;">
            <p>Native.js Footer Component</p>
        </footer>
    </template>
    
    <!-- Custom Implementation -->
    <script type="module">
        import { createNativeJs, NativeJsComponent, createNativeJsComponentRegistry } from "/lib/index.js";
        
        const container = document.querySelector('#app');

        // Footer component - can be nested in other components
        class FooterElement extends NativeJsComponent {
            static tagName = 'n-footer';
            static templateId = 'tpl-footer';

            onInit(urlPatternResult, state) {
                console.log('FooterElement initialized');
            }
        }

        // Main page component
        class MainElement extends NativeJsComponent {
            static tagName = 'n-main';
            static templateId = 'tpl-home';

            onInit(urlPatternResult, state) {
                console.log('MainElement initialized');
                const h1 = this.getChild('#main-h1');
                if (h1) {
                    h1.innerText = 'Main Page - Loaded';
                }
            }
        }

        // Hello World component
        class HelloWorldElement extends NativeJsComponent {
            static tagName = 'n-hello-world';
            static templateId = 'tpl-hello-world';

            onInit(urlPatternResult, state) {
                console.log('HelloWorldElement initialized');
            }
        }

        // Other Page component
        class OtherPageElement extends NativeJsComponent {
            static tagName = 'n-other-page';
            static templateId = 'tpl-other-page';

            onInit(urlPatternResult, state) {
                console.log('OtherPageElement initialized');
            }
        }

        // Register non-routed components manually
        const registry = createNativeJsComponentRegistry();
        registry.registerComponentClass(FooterElement);

        // Define routes
        const routes = [
            {
                pathname: '/',
                element: MainElement,
            },
            {
                pathname: '/hello-world',
                element: HelloWorldElement
            },
            {
                pathname: '/other-page',
                element: OtherPageElement
            }
        ];

        // Create and run the app
        const nativeJs = createNativeJs(container, routes);
        nativeJs.run();

        // Expose for debugging
        window.nativeJs = nativeJs;
    </script>
</body>
</html>
